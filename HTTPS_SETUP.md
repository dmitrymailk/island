# üîí –ù–∞—Å—Ç—Ä–æ–π–∫–∞ HTTPS –¥–ª—è —Ä–µ—à–µ–Ω–∏—è Mixed Content

## –ü—Ä–æ–±–ª–µ–º–∞

–í—ã –ø–æ–ª—É—á–∞–µ—Ç–µ –æ—à–∏–±–∫—É:
```
Mixed Content: The page at 'https://dmitrymailk.github.io/island/#/friends' 
was loaded over HTTPS, but requested an insecure resource 
'http://147.45.213.244/api/contacts/427649895'. 
This request has been blocked; the content must be served over HTTPS.
```

## –ü—Ä–∏—á–∏–Ω–∞

GitHub Pages —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ **HTTPS**, –∞ –≤–∞—à API —Å–µ—Ä–≤–µ—Ä –ø–æ **HTTP**. 
–ë—Ä–∞—É–∑–µ—Ä—ã –±–ª–æ–∫–∏—Ä—É—é—Ç Mixed Content (—Å–º–µ—à–∞–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç) –∏–∑ —Å–æ–æ–±—Ä–∞–∂–µ–Ω–∏–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

–ù—É–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å HTTPS –Ω–∞ –≤–∞—à–µ–º —Å–µ—Ä–≤–µ—Ä–µ `147.45.213.244`.

---

## üöÄ –®–∞–≥–∏ –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ (147.45.213.244):

#### 1. –°–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç

**–û–ø—Ü–∏—è A: –°–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç (–±—ã—Å—Ç—Ä–æ, –¥–ª—è —Ç–µ—Å—Ç–∞)**

```bash
cd /path/to/island/server
chmod +x generate-ssl-cert.sh
./generate-ssl-cert.sh
```

‚ö†Ô∏è **–í–Ω–∏–º–∞–Ω–∏–µ:** –ë—Ä–∞—É–∑–µ—Ä –ø–æ–∫–∞–∂–µ—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ. –í–∞–º –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç:
1. –û—Ç–∫—Ä—ã—Ç—å `https://147.45.213.244` –≤ –±—Ä–∞—É–∑–µ—Ä–µ
2. –ù–∞–∂–∞—Ç—å "–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ" ‚Üí "–ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ —Å–∞–π—Ç"
3. –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ API –∑–∞–ø—Ä–æ—Å—ã –±—É–¥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å

**–û–ø—Ü–∏—è B: Let's Encrypt (–¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞, —Ç—Ä–µ–±—É–µ—Ç –¥–æ–º–µ–Ω)**

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Certbot
sudo apt install certbot

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä
cd /path/to/island/server
docker compose down

# –ü–æ–ª—É—á–∏—Ç–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç (–∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à –¥–æ–º–µ–Ω)
sudo certbot certonly --standalone -d api.yourdomain.com

# –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã
sudo mkdir -p ./ssl
sudo cp /etc/letsencrypt/live/api.yourdomain.com/fullchain.pem ./ssl/cert.pem
sudo cp /etc/letsencrypt/live/api.yourdomain.com/privkey.pem ./ssl/key.pem
sudo chmod 644 ./ssl/*
```

#### 2. –û–±–Ω–æ–≤–∏—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é (—É–∂–µ —Å–¥–µ–ª–∞–Ω–æ –≤ –∫–æ–º–º–∏—Ç–µ)

–§–∞–π–ª—ã —É–∂–µ –æ–±–Ω–æ–≤–ª–µ–Ω—ã:
- ‚úÖ `docker-compose.yml` - –¥–æ–±–∞–≤–ª–µ–Ω Nginx
- ‚úÖ `nginx.conf` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è reverse proxy —Å SSL
- ‚úÖ `.github/workflows/deploy.yml` - –∏–∑–º–µ–Ω–µ–Ω URL –Ω–∞ HTTPS

#### 3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä —Å HTTPS

```bash
cd /path/to/island/server
docker compose up -d
```

#### 4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
docker compose ps

# –î–æ–ª–∂–Ω—ã –±—ã—Ç—å –∑–∞–ø—É—â–µ–Ω—ã:
# - ostrovok-telegram-bot
# - ostrovok-nginx

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ API
curl -k https://147.45.213.244/api/contacts/YOUR_USER_ID
```

#### 5. –û—Ç–∫—Ä–æ–π—Ç–µ –ø–æ—Ä—Ç—ã –≤ firewall

```bash
# –î–ª—è Ubuntu/Debian
sudo ufw allow 443/tcp
sudo ufw allow 80/tcp

# –î–ª—è CentOS/RHEL
sudo firewall-cmd --permanent --add-service=https
sudo firewall-cmd --permanent --add-service=http
sudo firewall-cmd --reload
```

---

### –ù–∞ GitHub (–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞):

#### 6. –ó–∞–∫–æ–º–º–∏—Ç—å—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

```bash
git add .
git commit -m "Add HTTPS support with Nginx reverse proxy"
git push origin main
```

–≠—Ç–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å—Ç–∏—Ç –Ω–æ–≤—ã–π –¥–µ–ø–ª–æ–π —Å HTTPS URL.

---

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞

1. **–î–æ–∂–¥–∏—Ç–µ—Å—å –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è GitHub Actions** (2-3 –º–∏–Ω—É—Ç—ã)
   - –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ "Actions" –≤–∞—à–µ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –¥–µ–ø–ª–æ–π –ø—Ä–æ—à–µ–ª —É—Å–ø–µ—à–Ω–æ

2. **–û—Ç–∫—Ä–æ–π—Ç–µ —Å–∞–π—Ç:** `https://dmitrymailk.github.io/island/`

3. **–û—Ç–∫—Ä–æ–π—Ç–µ DevTools (F12) ‚Üí Network**
   - –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∑–∞–≥—Ä—É–∑–∏—Ç—å –∫–æ–Ω—Ç–∞–∫—Ç—ã
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∑–∞–ø—Ä–æ—Å—ã –∏–¥—É—Ç –Ω–∞ `https://147.45.213.244`

4. **–ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ —Å–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç:**
   - –û—Ç–∫—Ä–æ–π—Ç–µ –æ—Ç–¥–µ–ª—å–Ω–æ–π –≤–∫–ª–∞–¥–∫–æ–π: `https://147.45.213.244`
   - –ü—Ä–∏–º–∏—Ç–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
   - –í–µ—Ä–Ω–∏—Ç–µ—Å—å –Ω–∞ —Å–∞–π—Ç –∏ –æ–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É

---

## üìÅ –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

```
server/
‚îú‚îÄ‚îÄ nginx.conf              # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Nginx —Å SSL
‚îú‚îÄ‚îÄ docker-compose.yml      # –û–±–Ω–æ–≤–ª–µ–Ω: –¥–æ–±–∞–≤–ª–µ–Ω Nginx
‚îú‚îÄ‚îÄ generate-ssl-cert.sh    # –°–∫—Ä–∏–ø—Ç –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω–æ–≥–æ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞
‚îú‚îÄ‚îÄ README-SSL.md           # –ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ SSL
‚îî‚îÄ‚îÄ .gitignore             # –ò—Å–∫–ª—é—á–∞–µ—Ç –ø—Ä–∏–≤–∞—Ç–Ω—ã–µ –∫–ª—é—á–∏ –∏–∑ git
```

---

## üêõ Troubleshooting

### –ü—Ä–æ–±–ª–µ–º–∞: ERR_CERT_AUTHORITY_INVALID

**–ü—Ä–∏—á–∏–Ω–∞:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç

**–†–µ—à–µ–Ω–∏–µ:**
1. –û—Ç–∫—Ä–æ–π—Ç–µ `https://147.45.213.244` –≤ –±—Ä–∞—É–∑–µ—Ä–µ
2. –ù–∞–∂–º–∏—Ç–µ "–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ" ‚Üí "–ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ —Å–∞–π—Ç"
3. –û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### –ü—Ä–æ–±–ª–µ–º–∞: Connection refused

**–ü—Ä–∏—á–∏–Ω–∞:** Nginx –Ω–µ –∑–∞–ø—É—â–µ–Ω –∏–ª–∏ –ø–æ—Ä—Ç –∑–∞–∫—Ä—ã—Ç

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
docker compose ps

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏
docker compose logs nginx

# –û—Ç–∫—Ä–æ–π—Ç–µ –ø–æ—Ä—Ç
sudo ufw allow 443
```

### –ü—Ä–æ–±–ª–µ–º–∞: Mixed Content –æ—à–∏–±–∫–∞ –≤—Å–µ –µ—â–µ –ø–æ—è–≤–ª—è–µ—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ:**
1. –û—á–∏—Å—Ç–∏—Ç–µ –∫–µ—à –±—Ä–∞—É–∑–µ—Ä–∞ (Ctrl+Shift+Delete)
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ GitHub Actions –¥–µ–ø–ª–æ–π –∑–∞–≤–µ—Ä—à–∏–ª—Å—è
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ DevTools, —á—Ç–æ –∑–∞–ø—Ä–æ—Å—ã –∏–¥—É—Ç –Ω–∞ HTTPS

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

- **–ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:** [server/README-SSL.md](server/README-SSL.md)
- **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–µ—Ä–≤–µ—Ä–∞:** [server/README.md](server/README.md)
- **–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:** [ENV.md](ENV.md)

---

## üéØ –†–µ–∑—é–º–µ

1. ‚úÖ **–ù–∞ —Å–µ—Ä–≤–µ—Ä–µ:** –ó–∞–ø—É—Å—Ç–∏—Ç–µ `./generate-ssl-cert.sh` –∏ `docker compose up -d`
2. ‚úÖ **–í GitHub:** –ó–∞–∫–æ–º–º–∏—Ç—å—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏ –∑–∞–ø—É—à—å—Ç–µ
3. ‚úÖ **–í –±—Ä–∞—É–∑–µ—Ä–µ:** –ü—Ä–∏–º–∏—Ç–µ —Å–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –Ω–∞ `https://147.45.213.244`
4. ‚úÖ **–ì–æ—Ç–æ–≤–æ!** –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å –±–µ–∑ –æ—à–∏–±–æ–∫ Mixed Content
