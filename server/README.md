# Telegram Bot Server

ะกะตัะฒะตัะฝะฐั ัะฐััั ะฟัะพะตะบัะฐ ั Telegram ะฑะพัะพะผ ะดะปั ะธะผะฟะพััะฐ ะบะพะฝัะฐะบัะพะฒ ะธ Express API ัะตัะฒะตัะพะผ.

## ๐ ะัััััะน ััะฐัั

### ะะฐะฟััะบ ัะตัะตะท Docker Compose (ัะตะบะพะผะตะฝะดัะตััั)

1. **ะฃะฑะตะดะธัะตัั, ััะพ ัะฐะนะป `.env` ัะพะทะดะฐะฝ ะฒ ะบะพัะฝะต ะฟัะพะตะบัะฐ:**

```bash
cd ..
```

ะกะพะทะดะฐะนัะต `.env` ัะฐะนะป:
```env
TELEGRAM_BOT_TOKEN=your_bot_token_from_BotFather
PORT=3001
```

2. **ะะตัะฝะธัะตัั ะฒ ะฟะฐะฟะบั server ะธ ะทะฐะฟัััะธัะต ะบะพะฝัะตะนะฝะตั:**

```bash
cd server
docker compose up -d
```

3. **ะัะพะฒะตัััะต ะปะพะณะธ:**

```bash
docker compose logs -f
```

ะั ะดะพะปะถะฝั ัะฒะธะดะตัั:
```
ะะพั @ะฒะฐั_ะฑะพั ััะฟะตัะฝะพ ะทะฐะฟััะตะฝ...
ะกะตัะฒะตั API ะทะฐะฟััะตะฝ ะฝะฐ http://localhost:3001
```

4. **ะัะบัะพะนัะต ะฑะพัะฐ ะฒ Telegram ะธ ะพัะฟัะฐะฒััะต `/start`**

### ะะฐะฟััะบ ะฑะตะท Docker

```bash
# ะะท ะบะพัะฝั ะฟัะพะตะบัะฐ
npm install
npm run server
```

## ๐ฆ ะงัะพ ะฒะฝัััะธ

```
server/
โโโ index.js              # ะัะฝะพะฒะฝะพะน ัะฐะนะป ัะตัะฒะตัะฐ
โโโ db.json              # ะะฐะทะฐ ะดะฐะฝะฝัั ะบะพะฝัะฐะบัะพะฒ (ัะพะทะดะฐะตััั ะฐะฒัะพะผะฐัะธัะตัะบะธ)
โโโ Dockerfile           # Docker ะพะฑัะฐะท ะดะปั ัะตัะฒะตัะฐ
โโโ docker-compose.yml   # ะะพะฝัะธะณััะฐัะธั Docker Compose
โโโ .dockerignore        # ะคะฐะนะปั, ะธะณะฝะพัะธััะตะผัะต ะฟัะธ ัะฑะพัะบะต ะพะฑัะฐะทะฐ
โโโ README.md           # ะญัะฐ ะดะพะบัะผะตะฝัะฐัะธั
```

## ๐ณ Docker ะบะพะผะฐะฝะดั

### ะัะฝะพะฒะฝัะต ะบะพะผะฐะฝะดั

**ะะฐะฟััะบ ะฒ ัะพะฝะพะฒะพะผ ัะตะถะธะผะต:**
```bash
docker compose up -d
```

**ะัะพัะผะพัั ะปะพะณะพะฒ:**
```bash
docker compose logs -f
```

**ะััะฐะฝะพะฒะบะฐ ะบะพะฝัะตะนะฝะตัะฐ:**
```bash
docker compose down
```

**ะะตัะตะทะฐะฟััะบ:**
```bash
docker compose restart
```

**ะะตัะตัะฑะพัะบะฐ ะพะฑัะฐะทะฐ:**
```bash
docker compose up --build
```

### ะะพะฟะพะปะฝะธัะตะปัะฝัะต ะบะพะผะฐะฝะดั

**ะัะพัะผะพัั ััะฐัััะฐ:**
```bash
docker compose ps
```

**ะัะฟะพะปะฝะตะฝะธะต ะบะพะผะฐะฝะดั ะฒะฝัััะธ ะบะพะฝัะตะนะฝะตัะฐ:**
```bash
docker compose exec telegram-bot-server sh
```

**ะัะพัะผะพัั ะปะพะณะพะฒ ะทะฐ ะฟะพัะปะตะดะฝะธะต N ัััะพะบ:**
```bash
docker compose logs --tail=100
```

**ะััะฐะฝะพะฒะบะฐ ั ัะดะฐะปะตะฝะธะตะผ volumes:**
```bash
docker compose down -v
```

## ๐ง ะะพะฝัะธะณััะฐัะธั

### ะะตัะตะผะตะฝะฝัะต ะพะบััะถะตะฝะธั

ะคะฐะนะป `.env` ะดะพะปะถะตะฝ ะฝะฐัะพะดะธัััั ะฒ **ะบะพัะฝะต ะฟัะพะตะบัะฐ** (ะฝะฐ ััะพะฒะตะฝั ะฒััะต):

```env
# ะะฑัะทะฐัะตะปัะฝัะต ะฟะฐัะฐะผะตััั
TELEGRAM_BOT_TOKEN=your_bot_token_here

# ะะตะพะฑัะทะฐัะตะปัะฝัะต ะฟะฐัะฐะผะตััั
PORT=3001
NODE_ENV=production
```

### ะะพััั

- **3001** - Express API ัะตัะฒะตั (ะผะพะถะฝะพ ะธะทะผะตะฝะธัั ัะตัะตะท ะฟะตัะตะผะตะฝะฝัั `PORT`)

### Volumes

Docker Compose ะผะพะฝัะธััะตั ัะปะตะดัััะธะต ะดะธัะตะบัะพัะธะธ:

- `.:/app/server` - ะดะปั hot-reload ะฟัะธ ัะฐะทัะฐะฑะพัะบะต
- `./db.json:/app/server/db.json` - ัะพััะฐะฝะตะฝะธะต ะฑะฐะทั ะดะฐะฝะฝัั ะฝะฐ ัะพััะต

## ๐ก API Endpoints

### GET /api/contacts/:userId

ะะพะปััะธัั ัะฟะธัะพะบ ะบะพะฝัะฐะบัะพะฒ ะฟะพะปัะทะพะฒะฐัะตะปั.

**ะัะธะผะตั:**
```bash
curl http://localhost:3001/api/contacts/427649895
```

**ะัะฒะตั:**
```json
[
  {
    "phone_number": "+79272587856",
    "first_name": "ะัะธะฝะฐ",
    "last_name": "ะะฐะฟััะบ",
    "user_id": 5457930994
  }
]
```

### DELETE /api/contacts/:userId

ะฃะดะฐะปะธัั ะบะพะฝัะฐะบัั ะฟะพะปัะทะพะฒะฐัะตะปั.

**ะัะธะผะตั:**
```bash
curl -X DELETE http://localhost:3001/api/contacts/427649895 \
  -H "Content-Type: application/json" \
  -d '{"phones": ["+79272587856"]}'
```

**ะัะฒะตั:**
```json
{
  "message": "1 contacts deleted successfully."
}
```

## ๐ Troubleshooting

### ะัะพะฑะปะตะผะฐ: ะะพะฝัะตะนะฝะตั ะฝะต ะทะฐะฟััะบะฐะตััั

**ะะตัะตะฝะธะต:**
1. ะัะพะฒะตัััะต, ัะพะทะดะฐะฝ ะปะธ ัะฐะนะป `.env` ะฒ ะบะพัะฝะต ะฟัะพะตะบัะฐ
2. ะฃะฑะตะดะธัะตัั, ััะพ ะฒ `.env` ัะบะฐะทะฐะฝ ะบะพััะตะบัะฝัะน ัะพะบะตะฝ ะฑะพัะฐ
3. ะัะพะฒะตัััะต ะปะพะณะธ: `docker compose logs`

### ะัะพะฑะปะตะผะฐ: ะะพัั 3001 ะทะฐะฝัั

**ะะตัะตะฝะธะต 1:** ะะทะผะตะฝะธัะต ะฟะพัั ะฒ `.env`:
```env
PORT=3002
```

**ะะตัะตะฝะธะต 2:** ะะทะผะตะฝะธัะต ะผะฐะฟะฟะธะฝะณ ะฟะพััะพะฒ ะฒ `docker-compose.yml`:
```yaml
ports:
  - "3002:3001"
```

### ะัะพะฑะปะตะผะฐ: ะะพั ะฝะต ะพัะฒะตัะฐะตั ะฒ Telegram

**ะะตัะตะฝะธะต:**
1. ะัะพะฒะตัััะต ะปะพะณะธ: `docker compose logs -f`
2. ะฃะฑะตะดะธัะตัั, ััะพ ัะพะบะตะฝ ะฟัะฐะฒะธะปัะฝัะน
3. ะัะพะฒะตัััะต, ััะพ ะฑะพั ะฝะต ะทะฐะฟััะตะฝ ะฒ ะดััะณะพะผ ะผะตััะต
4. ะะตัะตะทะฐะฟัััะธัะต ะบะพะฝัะตะนะฝะตั: `docker compose restart`

### ะัะพะฑะปะตะผะฐ: ะะฐะทะฐ ะดะฐะฝะฝัั db.json ะฟัััะฐั ะฟะพัะปะต ะฟะตัะตะทะฐะฟััะบะฐ

**ะะตัะตะฝะธะต:**
ะฃะฑะตะดะธัะตัั, ััะพ ะฒ `docker-compose.yml` ะตััั ะผะฐะฟะฟะธะฝะณ:
```yaml
volumes:
  - ./db.json:/app/server/db.json
```

### ะัะพะฑะปะตะผะฐ: ะะทะผะตะฝะตะฝะธั ะฒ ะบะพะดะต ะฝะต ะฟัะธะผะตะฝััััั

**ะะตัะตะฝะธะต:**
1. ะะตัะตัะพะฑะตัะธัะต ะพะฑัะฐะท: `docker compose up --build`
2. ะะปะธ ะฟะตัะตะทะฐะฟัััะธัะต: `docker compose restart`

## ๐ ะะตะทะพะฟะฐัะฝะพััั

โ๏ธ **ะะฐะถะฝะพ:**
- ะะธะบะพะณะดะฐ ะฝะต ะบะพะผะผะธัััะต `.env` ัะฐะนะป ะฒ git
- ะะต ะฟัะฑะปะธะบัะนัะต ัะพะบะตะฝ ะฑะพัะฐ
- ะัะฟะพะปัะทัะนัะต `.gitignore` ะดะปั ะธัะบะปััะตะฝะธั ััะฒััะฒะธัะตะปัะฝัั ะดะฐะฝะฝัั

## ๐ ะะพะฟะพะปะฝะธัะตะปัะฝะฐั ะธะฝัะพัะผะฐัะธั

### ะะฐะบ ะฟะพะปััะธัั Telegram Bot Token

1. ะัะบัะพะนัะต Telegram ะธ ะฝะฐะนะดะธัะต [@BotFather](https://t.me/BotFather)
2. ะัะฟัะฐะฒััะต ะบะพะผะฐะฝะดั `/newbot`
3. ะกะปะตะดัะนัะต ะธะฝััััะบัะธัะผ:
   - ะะฒะตะดะธัะต ะธะผั ะฑะพัะฐ (ะฝะฐะฟัะธะผะตั, "Ostrovok Contacts Bot")
   - ะะฒะตะดะธัะต username ะฑะพัะฐ (ะดะพะปะถะตะฝ ะทะฐะบะฐะฝัะธะฒะฐัััั ะฝะฐ `bot`, ะฝะฐะฟัะธะผะตั, `ostrovok_contacts_bot`)
4. ะกะบะพะฟะธััะนัะต ะฟะพะปััะตะฝะฝัะน ัะพะบะตะฝ ะธ ะฒััะฐะฒััะต ะฒ `.env` ัะฐะนะป

### ะััะธัะตะบัััะฐ

```
โโโโโโโโโโโโโโโโ
โ   Telegram   โ
โ   User       โ
โโโโโโโโฌโโโโโโโโ
       โ ะัะฟัะฐะฒะบะฐ ะบะพะฝัะฐะบัะฐ
       โผ
โโโโโโโโโโโโโโโโโโโโ
โ  Telegram Bot    โ
โ  (node-telegram- โ
โ   bot-api)       โ
โโโโโโโโฌโโโโโโโโโโโโ
       โ ะกะพััะฐะฝะตะฝะธะต
       โผ
โโโโโโโโโโโโโโโโโโโโ
โ   db.json        โ
โ   (ัะฐะนะปะพะฒะพะต      โ
โ    ััะฐะฝะธะปะธัะต)    โ
โโโโโโโโฌโโโโโโโโโโโโ
       โ ะงัะตะฝะธะต
       โผ
โโโโโโโโโโโโโโโโโโโโ
โ  Express API     โ
โ  (REST)          โ
โโโโโโโโฌโโโโโโโโโโโโ
       โ HTTP ะทะฐะฟัะพั
       โผ
โโโโโโโโโโโโโโโโโโโโ
โ   Frontend       โ
โ   (React)        โ
โโโโโโโโโโโโโโโโโโโโ
```

## ๐ ะะธัะตะฝะทะธั

ะงะฐััั ะฟัะพะตะบัะฐ Ostrovok 2025.
